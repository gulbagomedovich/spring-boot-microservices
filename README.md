# spring-boot-microservices

## Архитектура микросервисов
![alt text](https://github.com/gulbagomedovich/spring-boot-microservices/blob/main/microservices-architecture.jpg)

### Служба отдела (department-service)
Служба предназначена для добавления нового отдела и получения существующего отдела по уникальному идентификатору.

Чтобы добавить новый отдел необходимо отправить POST-запрос по адресу http://localhost:8080/departments/ и передать JSON вида: {"name":"name","address":"address","code":"code"}.

Чтобы получить существующий отдел необходимо отправить GET-запрос по адресу http://localhost:8080/departments/{id}, подставив вместо id уникальный идентификатор отдела, который генерируется автоматически, инкреметируясь каждый раз, то есть при добавлении первого отдела id=1, для второго id=2 и т.д.

### Служба пользователя (user-service)
Служба предназначена для добавления нового пользователя и получения сщуествующего пользователя с информацией об его отделе по уникальному идентификатору пользователя. Служба пользователя вызывает службу отдела по адресу http://department-service/, используя балансировку нагрузки.

Чтобы добавить нового пользователя необходимо отправить POST-запрос по адресу http://localhost:8080/users/ и передать JSON вида: {"firstName":"firstName","lastName":"lastName","email":"email","departmentId":"departmentId"}.

Чтобы получить существующего пользователя с информацией об его отделе необходимо отправить GET-запрос по адресу http://localhost:8080/departments/{id}, подставив вместо id уникальный идентификатор пользователя, который генерируется автоматически, инкреметируясь каждый раз, то есть при добавлении первого пользователя id=1, для второго id=2 и т.д.

### API-шлюз (api-gateway)
Служба предназначена для маршрутизации поступающих запросов. Шлюз принимате запросы по адресу http://localhost:8080. На шлюзе настроены шаблон автоматического выключателя, который будет вызывать метод отступления если служба пользователя или служба отдела не доступны, и проверка состояния здоровья (health-check).

Запросы с предикатами /departments/** направляются на службу отдела, а запросы с предикатами /users/** - на службу пользователя.

### Реестр служб (service-registry)
Все службы регистрируются в реестре служб, чтобы службы могли общаться между собой, небеспокоясь о портах.

### Сервер конфигурации (config-server)
Сервер конфигурации используется, чтобы вынести общую конфигурацию в репозиторий на GitHub.

Чтобы получить необходимую конфигурацию службы подключаются к серверу конфигурации, а та, в свою очередь, к GitHub.

### Zipkin
Распределенная система отслеживания используется Zipkin, чтобы отслеживать трассировку вызываемых служб. Она упрощает работу, особенно, при возникновении ошибок.
